{% extends 'blog/base.html' %}

{% block title %}{{ post.title }}{% endblock %}

{% block content %}
<article>
    <h1>{{ post.title }}</h1>
    <p class="post-meta">By {{ post.author }} | {{ post.created_at }}</p>

    <p>{{ post.content }}</p>

    {% if user == post.author or user.is_staff %}
    <div class="actions">
        <a href="{% url 'edit_post' post.pk %}">‚úèÔ∏è Edit</a>
        <a href="{% url 'delete_post' post.pk %}">üóë Delete</a>
    </div>
    {% endif %}

    {% if user.is_authenticated %}
    <form action="{% url 'like_post' post.pk %}" method="post" style="display:inline;">
        {% csrf_token %}
        {% if liked %}
            <button type="submit" class="like-button">‚ù§Ô∏è Unlike</button>
        {% else %}
            <button type="submit" class="like-button">ü§ç Like</button>
        {% endif %}
    </form>
    <span>{{ total_likes }} like{{ total_likes|pluralize }}</span>
    {% else %}
    <p><a href="{% url 'login' %}">Login</a> to like this post.</p>
    {% endif %}

    <hr>

    <h3>Comments</h3>
    {% for comment in comments %}
    <div class="comment">
        <strong>{{ comment.author }}</strong><br>
        {{ comment.content }}<br>
        <small>{{ comment.created_at }}</small>
    </div>
    {% empty %}
    <p>No comments yet.</p>
    {% endfor %}

    <hr>

    {% if user.is_authenticated %}
    <h3>Add a comment</h3>
    <form method="post">
        {% csrf_token %}
        {{ form.as_p }}
        <button type="submit">Post Comment</button>
    </form>
    {% else %}
    <p><a href="{% url 'login' %}">Login</a> to add a comment.</p>
    {% endif %}
</article>

<style>
.post-meta { color: gray; font-size: 14px; }
.actions a, .like-button { margin-right: 10px; text-decoration: none; color: #007BFF; cursor: pointer; }
.like-button { border: none; background: none; font-size: 16px; }
.comment { margin-bottom: 15px; }
.comment small { color: gray; }
form button { padding: 5px 10px; cursor: pointer; }
</style>
{% endblock %}
